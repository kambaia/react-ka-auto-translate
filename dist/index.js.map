{"version":3,"file":"index.js","sources":["../src/utils/helpers/translator.ts","../src/utils/helpers/identical-translator.ts","../src/utils/helpers/google-translator.ts","../src/utils/helpers/cache-translator.ts","../src/utils/helpers/translator-factory.ts","../src/context/translator.tsx","../src/context/translate.tsx"],"sourcesContent":["import {TranslationOptions, CacheProvider} from '../../types/types';\n\nexport default class Translator {\n  to: string;\n  from: string;\n  cacheProvider?: CacheProvider;\n\n  constructor(options: TranslationOptions, cacheProvider?: CacheProvider) {\n    this.from = options.from;\n    this.to = options.to;\n    this.cacheProvider = cacheProvider;\n  }\n\n  translate(__value: string): Promise<string | undefined> {\n    throw new Error('You must extend the base `translate()` method!');\n  }\n}\n","import Translator from './translator';\n\nexport default class IdenticalTranslator extends Translator {\n  translate(value: string): Promise<string | undefined> {\n    return new Promise((resolve): void => {\n      resolve(value);\n    });\n  }\n}\n","import Translator from './translator';\n\nexport default class GoogleTranslator extends Translator {\n  async translate(value: string): Promise<string | undefined> {\n    const translation = await this.tryGetGoogleTranslation(value);\n\n    return translation;\n  }\n\n  async tryGetGoogleTranslation(value: string): Promise<string | undefined> {\n    try {\n      return await this.fetchGoogleTranslation(value);\n    } catch (e) {\n      return undefined;\n    }\n  }\n\n  async fetchGoogleTranslation(value: string): Promise<string> {\n    const response = await fetch(\n      `https://translation.googleapis.com/language/translate/v2?source=${this.from}&target=${this.to}&key=${'AIzaSyAfoW3-nAGT22_alscL8co5KnuBowWiSps'}&q=${value}&format=text`\n    );\n    const {data} = await response.json();\n\n    return data.translations[0].translatedText;\n  }\n}\n","import GoogleTranslator from './google-translator';\nimport {CacheProvider} from '../../types/types';\n\nexport default class CacheTranslator extends GoogleTranslator {\n  cacheProvider!: CacheProvider;\n\n  async translate(value: string): Promise<string | undefined> {\n    let translation = await this.cacheProvider.get(this.to, value);\n\n    if (!translation) {\n      translation = await this.tryGetGoogleTranslationAndCache(value);\n    }\n\n    return translation;\n  }\n\n  async tryGetGoogleTranslationAndCache(\n    value: string\n  ): Promise<string | undefined> {\n    const translation = await this.tryGetGoogleTranslation(value);\n\n    this.setCachedTranslationForValue(value, translation);\n    return translation;\n  }\n\n  setCachedTranslationForValue(value: string, translation?: string): void {\n    if (translation) {\n      this.cacheProvider.set(this.to, value, translation);\n    }\n  }\n}\n","import Translator from './translator';\nimport IdenticalTranslator from './identical-translator';\nimport CacheTranslator from './cache-translator';\nimport GoogleTranslator from './google-translator';\nimport {TranslationOptions, CacheProvider} from '../../types/types';\n\nexport default class TranslatorFactory {\n  static create(\n    options: TranslationOptions,\n    cacheProvider?: CacheProvider\n  ): Translator {\n    if (this.isToLanguageIdenticalWithFrom(options.to, options.from)) {\n      return new IdenticalTranslator(options);\n    }\n\n    if (this.isCachable(cacheProvider)) {\n      return new CacheTranslator(options, cacheProvider);\n    }\n\n    return new GoogleTranslator(options);\n  }\n\n  static isToLanguageIdenticalWithFrom = (\n    to: string,\n    from: string\n  ): boolean => {\n    return to === from;\n  };\n\n  static isCachable = (cacheProvider?: CacheProvider): boolean => {\n    return !!cacheProvider;\n  };\n}\n","import {createContext, useCallback} from 'react';\nimport TranslatorFactory from '../utils/helpers/translator-factory';\nimport {TranslationHandler, CacheProvider} from '../types/types';\nimport * as React from 'react';\n\nconst defaultHandler: TranslationHandler = () => {};\n\nexport const TranslateContext: React.Context<\n  TranslationHandler\n> = createContext(defaultHandler);\nexport const LanguageContext: React.Context<string> = createContext('en');\n\ntype Props = {\n  to: string;\n  from: string;\n  cacheProvider?: CacheProvider;\n  children: any;\n};\n\nexport default function KTranslator({\n  to,\n  from,\n  cacheProvider,\n  children\n}: Props): JSX.Element {\n  \n  const handleTranslationAsync: TranslationHandler = useCallback(\n    async (value, setTranslation) => {\n      const options = {\n        to,\n        from,\n      };\n      const translator = TranslatorFactory.create(options, cacheProvider);\n      const translation = await translator.translate(value);\n\n      if (translation) {\n        setTranslation(translation);\n      }\n    },\n    [to, from, cacheProvider]\n  );\n\n  return (\n    <TranslateContext.Provider value={handleTranslationAsync}>\n      <LanguageContext.Provider value={to}>{children}</LanguageContext.Provider>\n    </TranslateContext.Provider>\n  );\n}\n","import {useContext, useEffect, useState} from 'react';\nimport {TranslateContext, LanguageContext} from './translator';\n\nexport default function KTranslate({\n  children: value,\n}: {\n  children: any;\n}): any {\n  const language = useContext(LanguageContext);\n  const handleTranslate = useContext(TranslateContext);\n  const [translation, setTranslation] = useState(value);\n\n  useEffect(() => {\n    handleTranslate(value, setTranslation);\n  }, [value, language]);\n\n  return translation;\n}\n"],"names":["createContext","useCallback","React","useContext","useState","useEffect"],"mappings":"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"}